type: object
  description: Contains optional fields required by 3DS 2 authentication protocol.
#  required: [sdk]
  properties: 
    challangeRequested:
      type: string
      description: Merchant's preference regarding 3DS 2 challenge. Exclusive with exemption. Maybe overridden by PayU.
      enum: 
        - "YES"
        - "NO"
        - "MANDATE"
    exemption:
      $ref: threeDsAuthentication_exemption.yaml
    browser:
      description: Browser data required for 3DS 2 browser flow. If not provided, these data will be collected by PayU. It is strongly recommended to include it when charging a stored card (multi-use token), because in some cases it will spare you redirection to PayU's authentication page.
      required: 
        [acceptHeaders, requestIP, screenWidth, javaEnabled, timezoneOffset, screenHeight, userAgent, colorDepth, language]
      properties: 
        acceptHeaders:
          type: string
          description: Exact content of the HTTP accept headers as sent from the payer's browser.
        requestIP:
          type: string
          description: IP address of the browser as returned by the HTTP headers.
        screenWidth:
          type: string
          description: Total width of the payer's screen in pixels. Obtained from the screen.width HTML DOM property.
        javaEnabled:
          type: boolean
          description: Obtained from the navigator HTML DOM object.
        timezoneOffset:
          type: string
          description: Obtained from the getTimezoneOffset() method applied to Date object.
        screenHeight:
          type: string
          description: Obtained from the navigator HTML DOM object.
        userAgent:
          type: string
          description: Exact content of the HTTP user-agent header.
        colorDepth:
          type: string
          description: Obtained from payer's browser using the screen.colorDepth HTML DOM property.
        language:
          type: string
          description: Obtained from payer's browser using the navigator.language HTML DOM property. Max. 8 chars.
    sdk:
      type: object
      description:  Required if 3DS 2 is to be natively supported in your mobile app. Content needs to be generated by a certified 3DS 2 SDK. This information is not required, but it is strongly recommended to include it when charging a stored card (multi-use token).
      required: 
        [sdkReferenceNumber, sdkMaxTimeout, sdkAppID, sdkEncData, sdkTransID, sdkEphemPubKey]
      properties: 
        sdkReferenceNumber:
          type: string
          example: DS_LOA_SDK_ADBV_739485_94783
        sdkMaxTimeout:
          type: string
          description:  Indicates the maximum amount of time (in minutes) for all exchanges. The field shall have value greater or equal to 05.
        sdkAppID:
          type: string
          example: 9063b12c-fcde-43c7-b28e-8d0af5520e8a
        sdkEncData:
          type: string
          description: Data encrypted by the 3DS SDK.
        sdkTransID:
          type: string
          example: b60c9879-ac77-4918-a317-7b01c4317053/8Q==.
        sdkEphemPubKey:
          type: string
          description: Public key component of the ephemeral key pair generated by the 3DS SDK and used to establish session keys between the 3DS SDK and the issuer.
    merchantRiskIndicator:
      type: object
      description: Set of fields helping to assess risk connected with the order itself (type of goods purchased, shipping method etc.).
      properties: 
        orderType:
          type: string
          enum: [PURCHASE, ACC_FUNDING, LOAN]
        shipIndicator:
          type: string
          enum: [BILLING_ADDRESS, VERIFIED_ADDRESS, OTHER_ADDRESS, SHIP_TO_STORE, DIGITAL_GOODS, TICKETS, NOT_SHIPPED]
          description: Indicates shipping method chosen for the order.
        preOrdered:
          type: boolean
          description: Indicates order for merchandise with a future availability or release date.
        preOrderedDate:
          type: string
          example: "2019-03-27T10:57:59.000+01:00"
          format: "2019-03-27T10:57:59.000+01:00"
          description: ISO format applies.
        deliveryTimeFrame:
          type: string
          enum: [ELECTRONIC, SAME_DAY, OVERNIGHT, TWO_OR_MORE_DAYS]
        reordered:
          type: boolean
          description: Indicates if the same purchase has been ordered again.
        merchantFunds:
          type: object
          description: Indicates whether merchant's own funding (e.g. a gift card) has been used to partially pay for the order. Sum of amounts provided here and of <totalAmount> field denote the real value of order in merchant's system.
          required: [amount, currencyCode]
          properties: 
            amount:
              type: string
              description: In pennies.
            currencyCode:
              type: string
              description: Currency code compliant with ISO 4217.
    recurring:
      type: object
      description: Additional information in case of a recurring payment.
      properties: 
        frequency:
          type: string
          description: Minimum number of days between payments.
        expiry:
          type: string
          format: '2019-03-27T10:57:59.000+01:00'
          description: Date after no further recurring payments will be performed.
    cardholder:
      type: object
      description: Describes cardholder's account data in merchant's possession, including details of account run for the cardholder in merchant's system.
      properties: 
        name:
          type: string
          description: Cardholder name and surname.
        accountInformation:
          type: object
          description: Informations about cardholders account.
          properties: 
            createDate:
              type: string
              format: '2019-03-27T10:57:59.000+01:00'
              description: Date when the account has been created for the cardholder.
            suspiciousActivity:
              type: boolean
              description: Indicates whether merchant has experienced suspicious/fraudulent activity for this account.
            deliveryAddressFirstUsedDate:
              type: string
              format: '2019-03-27T10:57:59.000+01:00'
              description: Date when the shipping address used for this order was first used.
            deliveryAdressUsageIndicator:
              type: string
              enum: [THIS_TRANSACTION, LESS_THAN_30_DAYS, 30_TO_60_DAYS, MORE_THAN_60_DAYS]
              description: Indicates when this shipping address was first used.
            pastOrdersYear:
              type: integer
              description: Orders created in merchant's system for this account in the past 12 months.
              minimum: 1
              maximum: 9999
            pastOrdersDay:
              type: integer
              description: Orders created in merchant's system for this account in the last 24 hours.
              minimum: 1
              maximum: 9999
            purchasesLastSixMonths:
              type: integer
              description: Fulfilled (successful) orders created in merchant's system for this account in the past 6 months.
              minimum: 1
              maximum: 9999
            changeDate:
              type: string
              format: '2019-03-27T10:57:59.000+01:00'
              description: Date when account details were last changed.
            changeIndicator:
              type: string
              enum: [THIS_TRANSACTION, LESS_THAN_30_DAYS, 30_TO_60_DAYS, MORE_THAN_60_DAYS]
              description: Indicates time when account information was last changed.
            passwordChanged:
              type: string
              format: '2019-03-27T10:57:59.000+01:00'
              description: Date when account password was last changed.
            passwordChangeIndicator:
              type: string
              enum: [NO_CHANGE, THIS_TRANSACTION, LESS_THAN_30_DAYS, 30_TO_60_DAYS, MORE_THAN_60_DAYS]
              description: Indicates whether and when the password was last changed.
            nameToRecipientMatch:
              type: boolean
              description: Indicates whether cardholder's name matches recipient's name.
            addCardAttemptsDay:
              type: string
              description: Indicates attempts to add a card to cardholder's account in merchant's system within last 24 hours.
            authMethod:
              type: string
              enum: [GUEST, LOGIN, FEDERATED_ID, THIRD_PARTY, ISSUER, FIDO]
              description: Authentication method used to recognize cardholder.
            authDateTime:
              type: string
              format: '2019-03-27T10:57:59.000+01:00'
              description: Date and time when authentication was performed.
            cardAddedDate:
              type: string
              format: '2019-03-27T10:57:59.000+01:00'
              description: Date when card account has been stored with merchant.
            cardAddedIndicator:
              type: string
              enum: [GUEST, THIS_TRANSACTION, LESS_THAN_30_DAYS, 30_TO_60_DAYS, MORE_THAN_60_DAYS]
              description: Indicates if and when the card was stored with merchant.
        billingAddress:
          type: object
          properties: 
            street:
              type: string
              minLength: 1
              maxLength: 50
              description: Full street address, incl. apartment number.
            postalCode:
              type: string
              minLength: 1
              maxLength: 16
              description: Postal/ZIP code.
            city:
              type: string
              minLength: 1
              maxLength: 50
              description: City name.
            state:
              type: string
              minLength: 1
              maxLength: 3
              description: Country principal subdivision like "state" or "province". If provided, must be a two-letter country code compliant with ISO-3166.
            countryCode:
              type: string
              minLength: 1
              maxLength: 2
              description: Two-letter country code compliant with ISO-3166.